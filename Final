
import gi
import subprocess
from gi.repository import Gtk, GtkSource, GdkX11, Gdk

def main():
    # Load the Glade file
    builder = Gtk.Builder()
    builder.add_from_file("/home/operator/tmc/python/images/tormach_mill_ui.glade")
    # Get the main window and notebook
    window = builder.get_object("main_window")
    notebook = builder.get_object("notebook")  # Get the notebook widget

    # Find the notebook page
    notebook_page = notebook.get_nth_page(1)  # Adjust index if needed
    
    # Get the GtkFixed container and placeholder
    #fixed_container = builder.get_object("gcode_page_fixed")  # ID of GtkFixed container
    placeholder = builder.get_object("drawingarea4")  # ID of placeholder widget
    parent = placeholder.get_parent()
    if placeholder:
        # Remove the placeholder from the fixed container
        parent.remove(placeholder)

        # Create a new GtkSourceView widget
        source_view = GtkSource.View()

        # Add the GtkSourceView widget to the fixed container at specific coordinates
        parent.add(placeholder)
        parent.show_all()# all children

    # Get the drawing area for the webcam
    drawing_area = builder.get_object("drawingarea1")

    # Show the window
    window.show_all()

    # Get the XID of the drawing area
    xid = drawing_area.get_window().get_xid()

    # Run mplayer with the XID embedded in the drawing area
    command = "mplayer tv:// -tv driver=v4l2:device=/dev/video0 -wid %d" % xid
    subprocess.Popen(command, shell=True)

    # Start the GTK main loop
    Gtk.main()

if __name__ == "__main__":
    main()


